using IRI.Sta.Common.Security;

namespace IRI.Test.NetFrameworkTest.Common;


public class CryptographyTest
{
    [Fact]
    public void TestSecureMessage()
    {
        var publicKey = @"PFJTQUtleVZhbHVlPjxNb2R1bHVzPjh6VU9UWnM1WW81RWlqa3pJZFZqaVE3Zkx3SVk1NlZoeGUxdVl0KzU4djBPSGZ5VDhsczFmRzcxYUg1LzQrVlFSVnV2NEpFSnhQQW5VZGtPakJTa3U0eUxBdEhUazRaVEQ4SzE4cFNuTlNjeHZzRytvOEVxWWtlakVvcmwyZ3VDQ1l6VlBjdCs3clRJbXVhNzZUR1VnYjlTL3Z2ei8rMmNsS1RpZUtMUmluaz08L01vZHVsdXM+PEV4cG9uZW50PkFRQUI8L0V4cG9uZW50PjwvUlNBS2V5VmFsdWU+";

        var privateKey = @"PFJTQUtleVZhbHVlPjxNb2R1bHVzPjh6VU9UWnM1WW81RWlqa3pJZFZqaVE3Zkx3SVk1NlZoeGUxdVl0KzU4djBPSGZ5VDhsczFmRzcxYUg1LzQrVlFSVnV2NEpFSnhQQW5VZGtPakJTa3U0eUxBdEhUazRaVEQ4SzE4cFNuTlNjeHZzRytvOEVxWWtlakVvcmwyZ3VDQ1l6VlBjdCs3clRJbXVhNzZUR1VnYjlTL3Z2ei8rMmNsS1RpZUtMUmluaz08L01vZHVsdXM+PEV4cG9uZW50PkFRQUI8L0V4cG9uZW50PjxQPjlOK0grNFZzQVNLVUM2NG1oWWJsV2pRTFc1a2crRjhNeTFxSlV0cHN0WW8wczJIRWM5cHNwT1plbTI3NlVNckdINkRSbmhVM040U3FpZkFCMmhlWjN3PT08L1A+PFE+L2tJbFlPVi9DL2U3bEdYbFlNRjB6N0JqdVBxQkY4UUtoWWZEY1RObWhHTGI4VmI1K2F0R0s3Y0FHelZMYWZuUHl0N3hjeFNTekwyTjVKSGQ5aTBXcHc9PTwvUT48RFA+MUlidFRxK04vYTQxTDY0R1lQMmpNWmJhQkxYeWw1NW5URmRYdUVFNitKVHJDSVZpSytyM1FHZHcxUmFNeW5JelltQUJqbUo3ZWdQNnY1MCsvanBkb1E9PTwvRFA+PERRPjNIMStMcTQyWTZsOCtPNzRZTlRET015TlhqK1dyWVpyWFdyam1RcHJEOGt2VlBZSkozTlpFZFhMK014Wnp0ZzlVMy9Nd1BDSmNaVzhOQWd2QlNvS3B3PT08L0RRPjxJbnZlcnNlUT4zYVg4SWtmeUlzQzFWMHdSeWYxcnhOU3VoRENvREc3Qkh5Y0xrQ2dTczVqUTQ4TDFTbVRMdysvZGgrUTMxVUswVXdleG5WbWhjamsrMHdpTGxENXlzQT09PC9JbnZlcnNlUT48RD5QeXNpb2VtVlNCSG5uM2NuM3J2TDlJZFdWS0ZZMHFIVCtWS24veXBZNDlIeVhydUJ1Y3NTNDFUMmpNTitlRFRSV3BKcjVnb0YzWTc2eDNsM0c4OG8wY1FVNWN0dStZTXl5RVMyaEhINTFTdEJiMVpzK3kxOTFXeXR1VERpWHpNRVhIbjlITi9Ob2s2ckpDRGhvdVZ6TDYvQmhhaUFDT3lwT1pZdUZNTnJMaGs9PC9EPjwvUlNBS2V5VmFsdWU+";


        var message = "hello!";

        var encryptedMessage = EncryptedMessage.Create(message, publicKey);

        Assert.Equal(encryptedMessage.Decrypt<string>(privateKey), message);
    }
}
